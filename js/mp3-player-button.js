/*

  SoundManager 2 Demo: Play MP3 links via button
  ----------------------------------------------

  http://schillmania.com/projects/soundmanager2/

  A simple demo making MP3s playable "inline"
  and easily styled/customizable via CSS.

  A variation of the "play mp3 links" demo.

  Requires SoundManager 2 Javascript API.

*//*jslint white: false, onevar: true, undef: true, nomen: false, eqeqeq: true, plusplus: false, bitwise: true, regexp: false, newcap: true, immed: true *//*global document, window, soundManager, navigator */function BasicMP3Player(){var a=this,b=this,c=soundManager,d=navigator.userAgent.match(/ipad|iphone/i),e=navigator.userAgent.match(/msie/i);this.excludeClass="button-exclude",this.links=[],this.sounds=[],this.soundsByURL=[],this.indexByURL=[],this.lastSound=null,this.soundCount=0,this.config={playNext:!1,autoPlay:!1},this.css={sDefault:"sm2_button",sLoading:"sm2_loading",sPlaying:"sm2_playing",sPaused:"sm2_paused"},this.includeClass=this.css.sDefault,this.addEventHandler=typeof window.addEventListener!="undefined"?function(a,b,c){return a.addEventListener(b,c,!1)}:function(a,b,c){a.attachEvent("on"+b,c)},this.removeEventHandler=typeof window.removeEventListener!="undefined"?function(a,b,c){return a.removeEventListener(b,c,!1)}:function(a,b,c){return a.detachEvent("on"+b,c)},this.classContains=function(a,b){return typeof a.className!="undefined"?a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)")):!1},this.addClass=function(b,c){if(!b||!c||a.classContains(b,c))return!1;b.className=(b.className?b.className+" ":"")+c},this.removeClass=function(b,c){if(!b||!c||!a.classContains(b,c))return!1;b.className=b.className.replace(new RegExp("( "+c+")|("+c+")","g"),"")},this.getSoundByURL=function(b){return typeof a.soundsByURL[b]!="undefined"?a.soundsByURL[b]:null},this.isChildOfNode=function(a,b){if(!a||!a.parentNode)return!1;b=b.toLowerCase();do a=a.parentNode;while(a&&a.parentNode&&a.nodeName.toLowerCase()!==b);return a.nodeName.toLowerCase()===b?a:null},this.events={play:function(){b.removeClass(this._data.oLink,this._data.className),this._data.className=b.css.sPlaying,b.addClass(this._data.oLink,this._data.className)},stop:function(){b.removeClass(this._data.oLink,this._data.className),this._data.className=""},pause:function(){b.removeClass(this._data.oLink,this._data.className),this._data.className=b.css.sPaused,b.addClass(this._data.oLink,this._data.className)},resume:function(){b.removeClass(this._data.oLink,this._data.className),this._data.className=b.css.sPlaying,b.addClass(this._data.oLink,this._data.className)},finish:function(){b.removeClass(this._data.oLink,this._data.className),this._data.className="";if(b.config.playNext){var a=b.indexByURL[this._data.oLink.href]+1;a<b.links.length&&b.handleClick({target:b.links[a]})}}},this.stopEvent=function(a){typeof a!="undefined"&&typeof a.preventDefault!="undefined"?a.preventDefault():typeof window.event!="undefined"&&typeof window.event.returnValue!="undefined"&&(window.event.returnValue=!1);return!1},this.getTheDamnLink=e?function(a){return a&&a.target?a.target:window.event.srcElement}:function(a){return a.target},this.handleClick=function(b){if(typeof b.button!="undefined"&&b.button>1)return!0;var d=a.getTheDamnLink(b),e,f,g;if(d.nodeName.toLowerCase()!=="a"){d=a.isChildOfNode(d,"a");if(!d)return!0}e=d.getAttribute("href");if(!d.href||!soundManager.canPlayLink(d)||a.classContains(d,a.excludeClass))return!0;if(!a.classContains(d,a.includeClass))return!0;c._writeDebug("handleClick()"),f=d.href,g=a.getSoundByURL(f),g?g===a.lastSound?g.togglePause():(g.togglePause(),c._writeDebug("sound different than last sound: "+a.lastSound.sID),a.lastSound&&a.stopSound(a.lastSound)):(g=c.createSound({id:"basicMP3Sound"+a.soundCount++,url:f,onplay:a.events.play,onstop:a.events.stop,onpause:a.events.pause,onresume:a.events.resume,onfinish:a.events.finish}),g._data={oLink:d,className:a.css.sPlaying},a.soundsByURL[f]=g,a.sounds.push(g),a.lastSound&&a.stopSound(a.lastSound),g.play()),a.lastSound=g,a.stopEvent(b);return!1},this.stopSound=function(a){soundManager.stop(a.sID),d||soundManager.unload(a.sID)},this.init=function(){c._writeDebug("basicMP3Player.init()");var b,d,e=0,f=document.getElementsByTagName("a");for(b=0,d=f.length;b<d;b++)a.classContains(f[b],a.css.sDefault)&&!a.classContains(f[b],a.excludeClass)&&(a.links[e]=f[b],a.indexByURL[f[b].href]=e,e++);e>0&&(a.addEventHandler(document,"click",a.handleClick),a.config.autoPlay&&a.handleClick({target:a.links[0],preventDefault:function(){}})),c._writeDebug("basicMP3Player.init(): Found "+e+" relevant items.")},this.init()}var basicMP3Player=null;soundManager.preferFlash=!1,soundManager.onready(function(){basicMP3Player=new BasicMP3Player})